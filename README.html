<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<title>Tagonist</title>
		<link rel="stylesheet" href="http://www.w3.org/StyleSheets/Core/Ultramarine" type="text/css" />
	</head>
	
	<body>
		<h1>Tagonist</h1>
		<p>Tagonist is a laughably simple java web application framework.</p>
		
		<h2>Overview</h2>
		<p>
			Tagonist is an ultra-lightweight MVC webapp framework, similar in principal to
			Struts, WebWork, or Maverick.  Like its cousins, Tagonist offers:
		</p>
		
		<ul>
			<li>Clean separation of code and content - no need for scriptlets</li>
			<li>Form processing by conveniently populating beans from the HTTP request attributes</li>
		</ul>
		
		<p>
			However, <em>unlike</em> its cousins, Tagonist:
		</p>

		<ul>
			<li>
				Is trivial to learn and use.  One look at the examples and you will understand how to
				write your webapp immediately.  There are just two custom tags.
			</li>
			<li>
				Is trivial to configure.  There no servlets to configure and no XML to muck with.
				Just drop the tagonist.jar in your WEB-INF/lib and start using the two tagonist
				custom tags in your JSPs.
			</li>
			<li>
				Integrates seamlessly into any JSP-based portal or even other webapp frameworks.
				Your JSP includes tagonist actions, not the other way around.
			</li>
			<li>
				Encourages development of fine-grained actions which can be composed arbitrarily
				on a page.  You don't need to have one action class per screen.
			</li>
			<li>
				Allows many HTML developers to work on a project without fighting over
				checkouts for some sort of XML sitemap configuration file.
			</li>
			<li>
				Is composed of 8 java classes and less than 500 lines of code (including whitespace).
				Anyone can see how it works.
			</li>
		</ul>
		
		<h2>Simple JSP Pages</h2>
		<p>
			In essence, tagonist turns traditional MVC frameworks inside-out.  Here is a simple
			tagonist example which displays a list of bookmarks for a user:
		</p>
		<pre>
&lt;%-- bookmarks.jsp --%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;%@ taglib prefix="t" uri="http://www.tagonist.org/tagonist" %&gt;

&lt;t:action var="user" type="com.example.action.GetUser"/&gt;
&lt;t:action var="bookmarks" type="com.example.action.GetBookmarks"/&gt;

&lt;html&gt;
	&lt;head&gt;&lt;title&gt;Bookmarks&lt;/title&gt;&lt;/head&gt;
	&lt;body&gt;
		&lt;p&gt;Here are the bookmarks for ${user.name}:&lt;/p&gt;
		&lt;table&gt;
			&lt;c:forEach var="mark" items="${bookmarks}"&gt;
				&lt;tr&gt;&lt;td&gt;${mark.title}&lt;/td&gt;&lt;td&gt;${mark.url}&lt;/td&gt;&lt;/tr&gt;
			&lt;/c:forEach&gt;
		&lt;/table&gt;
	&lt;/body&gt;
&lt;/html&gt;
		</pre>
		
		<p>
			This page uses the <code>action</code> tag to instantiate and execute two actions.
			The first obtains information about a user, including the user's name.  The second obtains
			a list of bookmarks for a user.  Standard JSTL tags and expressions are used to render
			the data as HTML.</p>
		<p>
			Here is what the <code>GetUser</code> class might look like:
		</p>
		
		<pre>
/** GetUser.java:  Gets a UserDetail object and sets it as the model */
public class GetUser extends AbstractAction
{
	Long userId;
	public void setUserId(Long value) { this.userId = value; }
	
	public void execute() throws Exception
	{
		UserDetail detail = getUserDetail(id);
			
		this.getCtx().setModel(detail);
	}
}
		</pre>
		
		<p>
			If you are familiar with Struts, WebWork, or Maverick, the Action class should look familiar.
			The key details:
		</p>
		
		<ul>
			<li>
				Bean properties are populated from the HTTP request parameters.  In this example, the URL would be invoked
				like this:  http://www.example.com/bookmarks.jsp?userId=42
			</li>
			<li>An <code>ActionContext</code> is available to the action, which provides access to the servlet objects</li>
			<li>
				The action sets the object that is to become the resultant model.  If no model is explicitly set,
				the action itself becomes the model, and its getter methods are available in the JSP.
			</li>
		</ul>
		
		<p>
			Note that this is only one pattern of action class available; many others are possible
			by implementing the <code>Action</code> interface instead of extending <code>AbstractAction</code>.
		</p>
		
		<h2>Simple Form Processing</h2>
		<p>
			The typical web Model-View-Controller pattern goes something like this:
		</p>
		
		<ol>
			<li>A front servlet (the controller) receives your request</li>
			<li>The servlet looks up configuration in an XML sitemap file to determine which action class to execute</li>
			<li>The action class is executed, builds a data model from POJOs, and selects a view for rendering (usually just Success or Error)</li>
			<li>The servlet determines which JSP is associated with the view (again, using the XML sitemap) and forwards</li>
		</ol>
		
		<p>
			Tagonist form processing is similar, but replaces the front controller and XML sitemap
			with simple JSP files.  This is a much more intuitive approach:
		</p>
		
		<pre>
&lt;%-- signup.jsp --%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;

&lt;html&gt;
	&lt;head&gt;&lt;title&gt;Signup&lt;/title&gt;&lt;/head&gt;
	&lt;body&gt;
		&lt;c:if test="${!empty model.error}"&gt;
			&lt;p&gt;Error: ${model.error}&lt;p&gt;
		&lt;/c:if&gt;
		
		&lt;form action="submit_signup.jsp"&gt;
			Email:  &lt;input type="text" name="email" value="${model.email}"/&gt;
			&lt;input type="submit" value="Submit"&gt;
		&lt;/form&gt;
	&lt;/body&gt;
&lt;/html&gt;
		</pre>
		<hr/>
		<pre>
&lt;%-- signup_submit.jsp --%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;%@ taglib prefix="t" uri="http://www.tagonist.org/tagonist" %&gt;

&lt;t:action var="model" type="com.example.action.Signup"/&gt;

&lt;c:choose&gt;
	&lt;c:when test="${empty model.error}"&gt;
		&lt;c:redirect url="thanks.jsp"/&gt;
	&lt;/c:when&gt;
	&lt;c:otherwise&gt;
		&lt;jsp:forward page="signup.jsp"/&gt;
	&lt;/c:otherwise&gt;
&lt;/c:choose&gt;
		</pre>
		<hr/>
		<pre>
/** Signup.java:  Form processing action for signup */
public class Signup extends AbstractAction
{
	String email;
	public String getEmail() { return this.email; }
	public void setEmail(String value) { this.email = value; }
	
	String error;
	public String getError() { return this.error; }
	
	public void execute() throws Exception
	{
		if (this.email == null || this.email.indexOf('@') < 0)
			this.error = "That is not a valid email address";
		else
			signupPerson(this.email);
	}
}
		</pre>
		
		<p>
			Chronologically, this is what happens:
		</p>
		
		<ol>
			<li>User points their browser at signup.jsp</li>
			<li>signup.jsp is processed.  There is no model, so form renders normally</li>
			<li>User fills out form and hits submit</li>
			<li>Browser goes to submit_signup.jsp, passing the http request parameter <code>email</code></li>
			<li>submit_signup.jsp instantiates and executes the action class <code>Signup</code></li>
			<li>
				The <code>Signup</code> action validates the data and performs the signup business logic.
				The resulting model will be the action object itself.
			</li>
			<li>If there were no errors, submit_signup.jsp redirects to thanks.jsp</li>
			<li>
				If there were any errors in the model, submit_signup.jsp forwards back to signup.jsp.
				The model contains both the error message and the old input for pre-loading the form.
			</li>
		</ol>
		
		
		<h2>Conclusion</h2>
		<p>
			This is just a broad overview of what is possible with Tagonist.  In the
			sample applications, you will see examples of:
		</p>
		
		<ul>
			<li>Passing parameters to action classes from JSPs</li>
			<li>Pre-populating a form with data</li>
			<li>Using form bean classes declared separately from the action class</li>
			<li>Issuing redirects and forwards from action classes by throwing exceptions</li>
		</ul>
	</body>
</html>